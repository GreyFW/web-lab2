info:
  name: POST Create User
  type: http
  seq: 2

http:
  method: POST
  url: "{{base_url}}/greeting"
  body:
    type: json
    data: |
      {
        "name": "Ksenia",
        "surname": "Surname-i-dont-like"
      }
  auth: inherit

runtime:
  scripts:
    - type: after-response
      code: |-
        test("Статус должен быть 200", function() {
          expect(res.status).to.equal(200);
        });

        test("Ответ содержит text и id", function() {
          const data = res.body;
          expect(data).to.have.property("text");
          expect(data).to.have.property("id");
          expect(data.text).to.include("Ksenia");
        });

        // Сохраняем id в переменную окружения для двух др. тестов
        bru.setEnvVar("user_id", res.body.id);

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5
